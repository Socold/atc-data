<p class="auto-cursor-target"><br /></p>
<ac:structured-macro ac:name="details" ac:schema-version="1" ac:macro-id="28b7d879-550c-4376-96ff-fdbdfddf710b">
   <ac:rich-text-body>
      <p class="auto-cursor-target"><br /></p>
      <table class="wrapped confluenceTable">
         <colgroup>
            <col />
            <col />
         </colgroup>
         <tbody>
            <tr>
               <th class="confluenceTh">Title</th>
               <td class="confluenceTd">{{ title|e }}<br /></td>
            </tr>
            <tr>
               <th class="confluenceTh">Description</th>
               <td class="confluenceTd">{{ description|e }}<br /></td>
            </tr>
{% if loggingpolicy is defined and loggingpolicy != 'None' |length %}
               <tr>
                  <th class="confluenceTh">Logging Policy</th>
                  <td class="confluenceTd">
                     {%- if loggingpolicy |length > 1 -%}<ul>{%endif%}
                        {% for policy_name, policy_id in loggingpolicy %}
                        {%- if loggingpolicy |length > 1 -%}<li>{%endif%}<a href="{{confluence_viewpage_url}}{{policy_id}}">{{ policy_name }}</a>{%- if loggingpolicy |length > 1 -%}</li>{%endif%}
                        {% endfor %}
                     {%- if loggingpolicy |length > 1 -%}</ul>{%endif%}
                  </td>
               </tr>
{% else %}
                <tr>
                    <th class="confluenceTh">Logging Policy</th>
                    <td class="confluenceTd">
                        This Data Needed doesn't require any Logging Policy configuration
                    </td>
                </tr>
{% endif %}
{% if mitigation_policy is defined and mitigation_policy|length %}
               <tr>
                  <th class="confluenceTh">Mitigation Policy</th>
                  <td class="confluenceTd">
                     {%- if mitigation_policy |length > 1 -%}<ul>{%endif%}
                        {% for policy_name, policy_id in mitigation_policy %}
                        {%- if mitigation_policy |length > 1 -%}<li>{%endif%}<a href="{{confluence_viewpage_url}}{{policy_id}}">{{ policy_name }}</a>{%- if mitigation_policy |length > 1 -%}</li>{%endif%}
                        {% endfor %}
                     {%- if mitigation_policy |length > 1 -%}</ul>{%endif%}
                  </td>
               </tr>
{% else %}
{% endif %}
            <tr>
               <th class="confluenceTh">References</th>
               <td class="confluenceTd">
                  {%- if references |length > 1 -%}<ul>{%endif%}
                     {% for ref in references %}
                     {%- if references |length > 1 -%}<li>{%endif%}<a href="{{ ref |e }}">{{ ref |e }}</a>{%- if references |length > 1 -%}</li>{%endif%}
                     {% endfor %}
                  {%- if references |length > 1 -%}</ul>{%endif%}
               </td>
            </tr>
            <tr>
               <th class="confluenceTh">Platform</th>
                  <td class="confluenceTd">{{platform}}<br /></td>
            </tr>
            <tr>
               <th class="confluenceTh">Type</th>
               <td class="confluenceTd">{{ type|e }}<br /></td>
            </tr>
            <tr>
               <th class="confluenceTh">Provider</th>
               <td class="confluenceTd">{{ provider|e }}<br /></td>
            </tr>
            <tr>
               <th class="confluenceTh">Channel</th>
               <td class="confluenceTd">{{ channel|e }}<br /></td>
            </tr>
            <tr>
               <th class="confluenceTh">Fields</th>
               <td class="confluenceTd">
                  <ul>
                     {% for field in fields %}
                     <li>{{ field|e }}</li>
                     {% endfor %}
                  </ul>
               </td>
            </tr>
         </tbody>
      </table>
      <p class="auto-cursor-target"><br /></p>
   </ac:rich-text-body>
</ac:structured-macro>
<p class="auto-cursor-target"><br /></p>
{% if sample is defined and sample|length %}
<h1>Log Samples</h1>
<pre><br/></pre>
<ac:structured-macro ac:name="expand">
    <ac:parameter ac:name="title">Raw Log</ac:parameter>
    <ac:rich-text-body>
        <ac:structured-macro ac:name="code">
            <ac:parameter ac:name="language">xml</ac:parameter>
            <ac:plain-text-body>
                <![CDATA[{{ sample }}]]>
            </ac:plain-text-body>
        </ac:structured-macro>
    </ac:rich-text-body>
</ac:structured-macro>
{% else %}
{% endif %}
{% if enriched_sample is defined and enriched_sample|length %}
<ac:structured-macro ac:name="expand">
    <ac:parameter ac:name="title">Enriched Log</ac:parameter>
    <ac:rich-text-body>
        <ac:structured-macro ac:name="code">
            <ac:parameter ac:name="language">text</ac:parameter>
            <ac:plain-text-body>
                <![CDATA[{{ enriched_sample }}]]>
            </ac:plain-text-body>
        </ac:structured-macro>
    </ac:rich-text-body>
</ac:structured-macro>
{% else %}
{% endif %}
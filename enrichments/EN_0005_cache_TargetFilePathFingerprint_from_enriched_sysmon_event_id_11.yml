title: EN_0005_cache_TargetFilePathFingerprint_from_enriched_sysmon_event_id_11
description: >
  Cache field "TargetFilePathFingerprint" from enriched Sysmon Event ID 11 (File Create).
data_needed:
  - DN_0015_11_windows_sysmon_FileCreate
references:
  - https://www.slideshare.net/heirhabarov/hunting-for-privilege-escalation-in-windows-environment
author: Teymur Kheirkhabarov
requirements:
  - EN_0004_enrich_sysmon_event_id_11_with_TargetFilePathFingerprint
config: |
  We can use Logstash to cache data in Memcached. 
  Here is the config example:

  ```
  filter {
    # cahce TargetFilePathFingerprint field 
    if [event_id] == 11 and ([event_data][TargetFilename] =~ ".exe" or [event_data][TargetFilename] =~ ".dll" [event_data][TargetFilename] =~ ".sys" ) {
      memcached { 
        hosts => ["127.0.0.1:11211"]
        set => {
          "[@metadata][processinfo]" => "%{[event_data][TargetFilePathFingerprint]}"
        }
        ttl => 86400 # 24 hours
      }
    }
  }
  ```
